<!DOCTYPE html>
<html>
<head>
    <title>NYC Climate Resilience Story</title>
    <meta charset='utf-8'>
    <meta name='viewport' content='initial-scale=1,maximum-scale=1,user-scalable=no' />
    <link href='https://api.tiles.mapbox.com/mapbox-gl-js/v2.0.0/mapbox-gl.css' rel='stylesheet'/>
    <script src='https://api.tiles.mapbox.com/mapbox-gl-js/v2.0.0/mapbox-gl.js'></script>
    <script src="https://unpkg.com/scrollama"></script>
    <link rel="stylesheet" href="./style.css"> <!-- 별도 CSS 파일 -->
</head>
<body>
<div id='map'></div>
<div id='story'></div>
<script src='./config.js'></script>
<script>
    var map = new mapboxgl.Map({
        container: 'map',
        style: config.style,
        center: config.chapters[0].location.center,
        zoom: config.chapters[0].location.zoom,
        pitch: config.chapters[0].location.pitch,
        bearing: config.chapters[0].location.bearing,
        interactive: false
    });

    map.on('load', function() {
        var scroller = scrollama();
        scroller.setup({ step: '.step', offset: 0.5 })
            .onStepEnter(response => {
                var chapter = config.chapters.find(chap => chap.id === response.element.id);
                response.element.classList.add('active');
                map.flyTo(chapter.location);
                chapter.onChapterEnter.forEach(layer => {
                    map.setPaintProperty(layer.layer, 'fill-opacity', layer.opacity);
                });
            })
            .onStepExit(response => {
                response.element.classList.remove('active');
            });
    });

    var story = document.getElementById('story');
    config.chapters.forEach(chap => {
        var step = document.createElement('div');
        step.setAttribute('id', chap.id);
        step.classList.add('step');
        step.innerHTML = `<h3>${chap.title}</h3><img src="${chap.image}"><p>${chap.description}</p>`;
        story.appendChild(step);
    });
</script>
</body>
</html>




